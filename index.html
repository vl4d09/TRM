<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>AR Cube Test - Evolution Journey</title>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js@3.4.5/aframe/build/aframe-ar-nft.js"></script>
    
    <style>
        body { margin: 0; overflow: hidden; font-family: Arial, sans-serif; }
        
        .status {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            color: #FFD700;
            padding: 15px 30px;
            border-radius: 25px;
            z-index: 1000;
            font-weight: bold;
            font-size: 16px;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.5);
            text-align: center;
            max-width: 80%;
        }

        .progress {
            position: fixed;
            top: 80px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 15px;
            z-index: 1000;
        }

        .progress-dot {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: rgba(255,255,255,0.3);
            transition: all 0.3s ease;
        }

        .progress-dot.active {
            background: #FFD700;
            box-shadow: 0 0 20px #FFD700;
            transform: scale(1.2);
        }

        .reset-btn {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
            color: black;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            z-index: 1000;
        }

        .reset-btn:hover {
            background: linear-gradient(135deg, #FFA500 0%, #FF8C00 100%);
            transform: translateX(-50%) translateY(-2px);
        }
    </style>
</head>
<body>
    <div id="status" class="status">üì∏ Scan Photo 1 to begin evolution...</div>
    
    <div class="progress">
        <div class="progress-dot" id="dot1" title="Photo 1"></div>
        <div class="progress-dot" id="dot2" title="Photo 2"></div>
        <div class="progress-dot" id="dot3" title="Photo 3"></div>
    </div>

    <button id="reset-btn" class="reset-btn">üîÑ Reset</button>

    <a-scene
        embedded
        arjs="sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;"
        vr-mode-ui="enabled: false;">

        <!-- MARKER 1: Red Cube -->
        <a-nft
            id="marker1"
            type="nft"
            url="marker1"
            smooth="true"
            smoothCount="10"
            smoothTolerance=".01"
            smoothThreshold="5">
            
            <a-box
                id="cube1"
                position="0 100 0"
                scale="100 100 100"
                color="#FF0000"
                material="opacity: 0.9"
                animation="property: rotation; to: 0 360 0; loop: true; dur: 4000; easing: linear"
                animation__bounce="property: position; to: 0 150 0; from: 0 100 0; loop: true; dur: 2000; dir: alternate; easing: easeInOutQuad">
            </a-box>

            <a-text
                value="STAGE 1"
                position="0 220 0"
                scale="80 80 80"
                align="center"
                color="#FF0000"
                shader="flat">
            </a-text>
        </a-nft>

        <!-- MARKER 2: Green Cube -->
        <a-nft
            id="marker2"
            type="nft"
            url="marker2"
            smooth="true"
            smoothCount="10"
            smoothTolerance=".01"
            smoothThreshold="5">
            
            <a-entity id="scene2" visible="false">
                <a-box
                    id="cube2"
                    position="0 100 0"
                    scale="120 120 120"
                    color="#00FF00"
                    material="opacity: 0.9"
                    animation="property: rotation; to: 360 0 360; loop: true; dur: 3000; easing: linear"
                    animation__bounce="property: position; to: 0 160 0; from: 0 100 0; loop: true; dur: 1800; dir: alternate; easing: easeInOutQuad">
                </a-box>

                <a-text
                    value="STAGE 2"
                    position="0 240 0"
                    scale="90 90 90"
                    align="center"
                    color="#00FF00"
                    shader="flat">
                </a-text>
            </a-entity>
        </a-nft>

        <!-- MARKER 3: Blue Cube -->
        <a-nft
            id="marker3"
            type="nft"
            url="marker3"
            smooth="true"
            smoothCount="10"
            smoothTolerance=".01"
            smoothThreshold="5">
            
            <a-entity id="scene3" visible="false">
                <a-box
                    id="cube3"
                    position="0 100 0"
                    scale="150 150 150"
                    color="#0000FF"
                    material="opacity: 0.9"
                    animation="property: rotation; to: 0 360 360; loop: true; dur: 2500; easing: linear"
                    animation__bounce="property: position; to: 0 180 0; from: 0 100 0; loop: true; dur: 1500; dir: alternate; easing: easeInOutQuad">
                </a-box>

                <a-text
                    value="STAGE 3"
                    position="0 280 0"
                    scale="100 100 100"
                    align="center"
                    color="#0000FF"
                    shader="flat">
                </a-text>

                <a-text
                    value="EVOLUTION COMPLETE!"
                    position="0 220 0"
                    scale="60 60 60"
                    align="center"
                    color="#FFFFFF"
                    shader="flat">
                </a-text>
            </a-entity>
        </a-nft>

        <a-entity camera></a-entity>
    </a-scene>

    <script>
        const gameState = {
            stage1Scanned: false,
            stage2Scanned: false,
            stage3Scanned: false
        };

        document.addEventListener('DOMContentLoaded', function() {
            console.log('üéÆ AR Cube Test initialized');
            
            const statusDiv = document.getElementById('status');
            const resetBtn = document.getElementById('reset-btn');
            
            const marker1 = document.getElementById('marker1');
            const marker2 = document.getElementById('marker2');
            const marker3 = document.getElementById('marker3');

            const scene2 = document.getElementById('scene2');
            const scene3 = document.getElementById('scene3');

            const dot1 = document.getElementById('dot1');
            const dot2 = document.getElementById('dot2');
            const dot3 = document.getElementById('dot3');

            function updateStatus(message) {
                statusDiv.textContent = message;
                console.log('üìä', message);
            }

            function updateProgress() {
                dot1.classList.toggle('active', gameState.stage1Scanned);
                dot2.classList.toggle('active', gameState.stage2Scanned);
                dot3.classList.toggle('active', gameState.stage3Scanned);
            }

            // MARKER 1: Red Cube
            marker1.addEventListener('markerFound', function() {
                console.log('‚úÖ Photo 1 detected!');
                gameState.stage1Scanned = true;
                updateStatus('üî¥ Stage 1 Active - Red Cube! Scan Photo 2 next...');
                updateProgress();
                
                // Unlock stage 2
                scene2.setAttribute('visible', true);
            });

            marker1.addEventListener('markerLost', function() {
                console.log('‚ùå Photo 1 lost');
            });

            // MARKER 2: Green Cube
            marker2.addEventListener('markerFound', function() {
                if (!gameState.stage1Scanned) {
                    updateStatus('üö´ ERROR: You must scan Photo 1 first!');
                    console.log('‚ö†Ô∏è Blocked: Stage 1 not completed');
                    return;
                }
                
                console.log('‚úÖ Photo 2 detected!');
                gameState.stage2Scanned = true;
                updateStatus('üü¢ Stage 2 Active - Green Cube! Scan Photo 3 to complete...');
                updateProgress();
                
                // Unlock stage 3
                scene3.setAttribute('visible', true);
            });

            marker2.addEventListener('markerLost', function() {
                console.log('‚ùå Photo 2 lost');
            });

            // MARKER 3: Blue Cube
            marker3.addEventListener('markerFound', function() {
                if (!gameState.stage1Scanned) {
                    updateStatus('üö´ ERROR: You must scan Photo 1 first!');
                    console.log('‚ö†Ô∏è Blocked: Stage 1 not completed');
                    return;
                }
                
                if (!gameState.stage2Scanned) {
                    updateStatus('üö´ ERROR: You must scan Photo 2 before Photo 3!');
                    console.log('‚ö†Ô∏è Blocked: Stage 2 not completed');
                    return;
                }
                
                console.log('‚úÖ Photo 3 detected!');
                gameState.stage3Scanned = true;
                updateStatus('üîµ COMPLETE! All 3 stages done - Evolution successful! üéâ');
                updateProgress();
            });

            marker3.addEventListener('markerLost', function() {
                console.log('‚ùå Photo 3 lost');
            });

            // RESET BUTTON
            resetBtn.addEventListener('click', function() {
                gameState.stage1Scanned = false;
                gameState.stage2Scanned = false;
                gameState.stage3Scanned = false;
                
                scene2.setAttribute('visible', false);
                scene3.setAttribute('visible', false);
                
                updateStatus('üì∏ Scan Photo 1 to begin evolution...');
                updateProgress();
                
                console.log('üîÑ Reset complete');
            });
        });
    </script>
</body>
</html>